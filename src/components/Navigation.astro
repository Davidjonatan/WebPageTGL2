---
import AnimateEntrance from "./animations/AnimateEntrance";

const currentPath = Astro.url.pathname;
const isEnglish = currentPath.includes('/en/');

const getPath = (path: string) => {
  if (isEnglish) return `/public_html/en${path.replace('/public_html', '')}`;
  return `/public_html${path}`;
};

const getAlternateLanguagePath = () => {
  if (isEnglish) return currentPath.replace('/en/', '/');
  return currentPath.replace('/public_html', '/public_html/en');
};

const isActivePath = (path: string) => {
  const targetPath = getPath(path);
  return currentPath === targetPath || currentPath === `${targetPath}/`;
};
---

<header
  x-data="{ scrolled: false }"
  x-init="window.addEventListener('scroll', () => scrolled = window.scrollY > 0)"
  :class="scrolled ? 'bg-white/80 shadow-md backdrop-blur-md' : 'bg-transparent'"
  class="fixed top-0 left-0 w-full z-50 transition-all duration-500"
>
  <AnimateEntrance client:load origin="topRight" useScrollTrigger={false} triggerClass="footer-col" stagger={0.2}>
    <div class="w-full" x-data="{ mobileMenuOpen: false }">

      <!-- Barra principal -->
      <div class="flex items-center justify-between py-2 px-4 sm:px-6 border-b transition-all duration-300"
           x-bind:class="scrolled ? 'border-white/30' : 'border-transparent'">

        <!-- Logo -->
        <div class="flex items-center footer-col flex-shrink-0">
          <a href={getPath("/")} title="Home">
            <img class="h-10 sm:h-12 lg:h-14 w-auto object-contain" 
                 src="/public_html/images/logos/logosinfondo.png" 
                 alt="Logo" />
          </a>
        </div>

        <!-- Navegación Desktop -->
       <nav class="hidden lg:flex items-center flex-1 justify-center">
  <ul class="flex items-center gap-x-6 xl:gap-x-10">

    <!-- NOSOTROS -->
    <div
      class="group relative px-5 py-3 rounded-xl transition-all duration-500"
      :class="scrolled ? 'hover:bg-blue-50' : 'hover:bg-gray-600'"
    >
      <span
        class="absolute inset-0 rounded-xl border-2 border-transparent group-hover:border-blue-600 transition-all duration-500"
      ></span>
      <span
        class="absolute inset-0 rounded-xl border-2 border-blue-600 scale-90 group-hover:scale-100 opacity-0 group-hover:opacity-100 transition-all duration-500"
      ></span>

      <a
        href={getPath('/nosotros')}
        class="relative z-10 block font-semibold transition-all duration-300 text-base xl:text-lg tracking-wide text-center w-full h-full"
        :class="scrolled ? 'text-[#1C274C]' : 'text-white'"
      >
        {isEnglish ? 'ABOUT US' : 'NOSOTROS'}
      </a>
    </div>

    <!-- SERVICIOS -->
    <div
      class="group relative px-5 py-3 rounded-xl transition-all duration-500"
      :class="scrolled ? 'hover:bg-blue-50' : 'hover:bg-gray-600'"
    >
      <span
        class="absolute inset-0 rounded-xl border-2 border-transparent group-hover:border-blue-600 transition-all duration-500"
      ></span>
      <span
        class="absolute inset-0 rounded-xl border-2 border-blue-600 scale-90 group-hover:scale-100 opacity-0 group-hover:opacity-100 transition-all duration-500"
      ></span>

      <a
        href={getPath('/servicios')}
        class="relative z-10 block font-semibold transition-all duration-300 text-base xl:text-lg tracking-wide text-center w-full h-full"
        :class="scrolled ? 'text-[#1C274C]' : 'text-white'"
      >
        {isEnglish ? 'SERVICES' : 'NUESTROS SERVICIOS'}
      </a>
    </div>

    <!-- CONTACTO -->
    <div
      class="group relative px-5 py-3 rounded-xl transition-all duration-500"
      :class="scrolled ? 'hover:bg-blue-50' : 'hover:bg-gray-600'"
    >
      <span
        class="absolute inset-0 rounded-xl border-2 border-transparent group-hover:border-blue-600 transition-all duration-500"
      ></span>
      <span
        class="absolute inset-0 rounded-xl border-2 border-blue-600 scale-90 group-hover:scale-100 opacity-0 group-hover:opacity-100 transition-all duration-500"
      ></span>

      <a
        href={getPath('/contacto')}
        class="relative z-10 block font-semibold transition-all duration-300 text-base xl:text-lg tracking-wide text-center w-full h-full"
        :class="scrolled ? 'text-[#1C274C]' : 'text-white'"
      >
        {isEnglish ? 'CONTACT' : 'CONTACTANOS'}
      </a>
    </div>

  </ul>
</nav>

        <!-- Elementos derecha -->
        <div class="flex items-center gap-x-2 sm:gap-x-3 flex-shrink-0">

          <!-- Facebook -->
          
            <a href="https://www.facebook.com/share/16ns4Ae2CM/?mibextid=wwXIfr" target="_blank" rel="noopener noreferrer" class="footer-col">
              <svg class="w-7 h-7 sm:w-8 sm:h-8 transition duration-300 hover:scale-110" 
                   viewBox="0 0 32 32" 
                   x-bind:class="scrolled 
                     ? 'text-[#1C274C] hover:text-[#AFC1DB] hover:animate-bounce-slow' 
                     : 'text-white hover:text-gray-200 hover:animate-bounce-slow-inverted'">
                <!-- No scrolled: fondo blanco, icono azul -->
                <path x-show="!scrolled" fill="white" d="M6,2h20c2.2,0,4,1.8,4,4v20c0,2.2-1.8,4-4,4H6c-2.2,0-4-1.8-4-4V6C2,3.8,3.8,2,6,2z"/>
                <path x-show="!scrolled" fill="#1C274C" d="M13.2,16.1v9.7c0,0.1,0.1,0.3,0.3,0.3h3.9c0.2,0,0.3-0.1,0.3-0.3v-9.8h2.8c0.1,0,0.3-0.1,0.3-0.2l0.3-3
                c0-0.2-0.1-0.3-0.3-0.3h-3.1v-2.1c0-0.5,0.4-0.9,1-0.9h2.2c0.2,0,0.3-0.1,0.3-0.3V6.3C21,6.1,20.9,6,20.7,6h-3.6
                c-2.1,0-3.9,1.6-3.9,3.6v2.9h-1.9c-0.2,0-0.3,0.1-0.3,0.3v3c0,0.1,0.1,0.3,0.3,0.3h1.9V16.1z"/>
                
                <!-- Scrolled: fondo azul, icono blanco -->
                <path x-show="scrolled" fill="#1C274C" d="M6,2h20c2.2,0,4,1.8,4,4v20c0,2.2-1.8,4-4,4H6c-2.2,0-4-1.8-4-4V6C2,3.8,3.8,2,6,2z"/>
                <path x-show="scrolled" fill="white" d="M13.2,16.1v9.7c0,0.1,0.1,0.3,0.3,0.3h3.9c0.2,0,0.3-0.1,0.3-0.3v-9.8h2.8c0.1,0,0.3-0.1,0.3-0.2l0.3-3
                c0-0.2-0.1-0.3-0.3-0.3h-3.1v-2.1c0-0.5,0.4-0.9,1-0.9h2.2c0.2,0,0.3-0.1,0.3-0.3V6.3C21,6.1,20.9,6,20.7,6h-3.6
                c-2.1,0-3.9,1.6-3.9,3.6v2.9h-1.9c-0.2,0-0.3,0.1-0.3,0.3v3c0,0.1,0.1,0.3,0.3,0.3h1.9V16.1z"/>
              </svg>
            </a>

   
 <!-- Instagram -->
<a href="https://www.instagram.com/transportesgarzaleal/?igshid=YmMyMTA2M2Y%3D" target="_blank" rel="noopener noreferrer" class="footer-col">
  <svg 
    class="w-7 h-7 sm:w-8 sm:h-8 transition duration-300 hover:scale-110"
    viewBox="0 0 24 24" 
    fill="none" 
    xmlns="http://www.w3.org/2000/svg"
    x-bind:class="scrolled 
      ? 'text-[#1C274C] hover:text-[#AFC1DB] hover:animate-bounce-slow' 
      : 'text-white hover:text-gray-200 hover:animate-bounce-slow-inverted'">
    
    <!-- No scrolled: fondo blanco, icono azul -->
    <g x-show="!scrolled">
      <rect x="2" y="2" width="20" height="20" rx="4" fill="white"></rect>
      <path 
        fill-rule="evenodd" 
        clip-rule="evenodd" 
        d="M12 9C10.3431 9 9 10.3431 9 12C9 13.6569 10.3431 15 12 15C13.6569 15 15 13.6569 15 12C15 10.3431 13.6569 9 12 9ZM7 12C7 9.23858 9.23858 7 12 7C14.7614 7 17 9.23858 17 12C17 14.7614 14.7614 17 12 17C9.23858 17 7 14.7614 7 12ZM17.5 8C18.3284 8 19 7.32843 19 6.5C19 5.67157 18.3284 5 17.5 5C16.6716 5 16 5.67157 16 6.5C16 7.32843 16.6716 8 17.5 8Z"
        fill="#1C274C" />
    </g>

    <!-- Scrolled: fondo azul, icono blanco -->
    <g x-show="scrolled">
      <rect x="2" y="2" width="20" height="20" rx="4" fill="#1C274C"></rect>
      <path 
        fill-rule="evenodd" 
        clip-rule="evenodd" 
        d="M12 9C10.3431 9 9 10.3431 9 12C9 13.6569 10.3431 15 12 15C13.6569 15 15 13.6569 15 12C15 10.3431 13.6569 9 12 9ZM7 12C7 9.23858 9.23858 7 12 7C14.7614 7 17 9.23858 17 12C17 14.7614 14.7614 17 12 17C9.23858 17 7 14.7614 7 12ZM17.5 8C18.3284 8 19 7.32843 19 6.5C19 5.67157 18.3284 5 17.5 5C16.6716 5 16 5.67157 16 6.5C16 7.32843 16.6716 8 17.5 8Z"
        fill="white" />
    </g>
  </svg>
</a>

        <!--tiktok -->

        <a href="https://www.tiktok.com/@transportes.garza.leal?_t=ZS-90iHtSYYDGm&_r=1" target="_blank" rel="noopener noreferrer" class="footer-col">
  <svg
    class="w-7 h-7 sm:w-8 sm:h-8 transition duration-300 hover:scale-110"
    viewBox="0 0 32 32"
    xmlns="http://www.w3.org/2000/svg"
    x-bind:class="scrolled 
      ? 'text-[#1C274C] hover:text-[#AFC1DB] hover:animate-bounce-slow' 
      : 'text-white hover:text-gray-200 hover:animate-bounce-slow-inverted'"
  >
    <!-- No scrolled: fondo blanco, icono azul -->
    <path
      x-show="!scrolled"
      fill="white"
      d="M6,2h20c2.2,0,4,1.8,4,4v20c0,2.2-1.8,4-4,4H6c-2.2,0-4-1.8-4-4V6C2,3.8,3.8,2,6,2z"
    />
    <path
      x-show="!scrolled"
      fill="#1C274C"
      d="M19.5 8.4c1 .8 2.1 1.2 3.5 1.3v3.1c-1.3 0-2.4-.3-3.5-.9v5.9c0 3-2.4 5.5-5.5 5.5S8.5 20.8 8.5 17.7c0-3 2.4-5.5 5.5-5.5.2 0 .4 0 .6 0v3.3h-.6c-1.2 0-2.2 1-2.2 2.2 0 1.2 1 2.2 2.2 2.2 1.2 0 2.2-1 2.2-2.2V8.4h3.3z"
    />

    <!-- Scrolled: fondo azul, icono blanco -->
    <path
      x-show="scrolled"
      fill="#1C274C"
      d="M6,2h20c2.2,0,4,1.8,4,4v20c0,2.2-1.8,4-4,4H6c-2.2,0-4-1.8-4-4V6C2,3.8,3.8,2,6,2z"
    />
    <path
      x-show="scrolled"
      fill="white"
      d="M19.5 8.4c1 .8 2.1 1.2 3.5 1.3v3.1c-1.3 0-2.4-.3-3.5-.9v5.9c0 3-2.4 5.5-5.5 5.5S8.5 20.8 8.5 17.7c0-3 2.4-5.5 5.5-5.5.2 0 .4 0 .6 0v3.3h-.6c-1.2 0-2.2 1-2.2 2.2 0 1.2 1 2.2 2.2 2.2 1.2 0 2.2-1 2.2-2.2V8.4h3.3z"
    />
  </svg>
</a>

          <!-- Bandera -->
          <a href={getAlternateLanguagePath()} title={isEnglish ? "Switch to Spanish" : "Cambiar a inglés"} class="footer-col flex items-center">
            <img src={isEnglish ? "/public_html/images/logos/mexico.png" : "/public_html/images/logos/bandera_us.png"} 
                 alt={isEnglish ? "Bandera México" : "Bandera USA"} 
                 class="rounded-full object-cover hover:scale-105 transition-transform w-7 h-7 sm:w-8 sm:h-8" />
          </a>

          <!-- Botón menú móvil -->
          <button type="button" aria-label="Open menu" class="lg:hidden ml-2 transition-colors duration-300"
                  x-bind:class="scrolled ? 'text-slate-500' : 'text-white'" @click="mobileMenuOpen = !mobileMenuOpen">
            <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
              <path fill-rule="evenodd" d="M3 9a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 9Zm0 6.75a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"/>
            </svg>
          </button>

        </div>
      </div>

      <!-- Menú móvil -->
      <div x-show="mobileMenuOpen" x-transition:enter="transition transform duration-300" x-transition:enter-start="translate-x-full"
           x-transition:enter-end="translate-x-0" x-transition:leave="transition transform duration-300"
           x-transition:leave-start="translate-x-0" x-transition:leave-end="translate-x-full"
           class="fixed inset-0 z-50 flex justify-end">

        <!-- Fondo semitransparente -->
        <div class="fixed inset-0 bg-black/40" @click="mobileMenuOpen = false"></div>

        <!-- Panel lateral -->
        <div class="relative w-64 bg-white shadow-lg flex flex-col mt-0">
          <button class="absolute top-2 right-2 p-2 text-gray-700 hover:text-gray-900 transition"
                  @click="mobileMenuOpen = false" aria-label="Close menu">
            <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>

          <ul class="flex flex-col px-4 py-6 gap-2">
            <li><a href={getPath("/nosotros")} class="block py-2 px-3 rounded text-[#1C274C] hover:bg-blue-50 transition text-sm" @click="mobileMenuOpen = false">{isEnglish ? "About Us" : "Nosotros"}</a></li>
            <li><a href={getPath("/servicios")} class="block py-2 px-3 rounded text-[#1C274C] hover:bg-blue-50 transition text-sm" @click="mobileMenuOpen = false">{isEnglish ? "Services" : "Nuestros Servicios"}</a></li>
            <li><a href={getPath("/contacto")} class="block py-2 px-3 rounded text-[#1C274C] hover:bg-blue-50 transition text-sm" @click="mobileMenuOpen = false">{isEnglish ? "Contact" : "Contáctanos"}</a></li>
          </ul>
        </div>
      </div>

    </div>

    <style>
      @keyframes bounce-slow {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-3px); }
      }
      @keyframes bounce-slow-inverted {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(3px); }
      }
      .hover\:animate-bounce-slow:hover { animation: bounce-slow 2s infinite; }
      .hover\:animate-bounce-slow-inverted:hover { animation: bounce-slow-inverted 2s infinite; }
      .group:hover span:nth-child(2) { transition-delay: 0.1s; transform-origin: center; }
    </style>

  </AnimateEntrance>
</header>