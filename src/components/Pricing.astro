---
import AnimateEntrance from "./animations/AnimateEntrance";
import AnimatedGlowBorder from "./animations/AnimatedGlowBorder"; 

export interface Service {
  title: string;
  image: string;
  tabKey: string;
}

export interface Props {
  mainTitle?: string;
  services?: Service[];
  buttonText?: string;
  baseUrl?: string;
}

const {
  mainTitle = "Nuestros Servicios",
  services = [
    { title: "Tanques", image: "/public_html/images/index/tanque2.jpg", tabKey: "tab1" },
    { title: "Cajas Secas", image: "/public_html/images/index/seca.jpg", tabKey: "tab2" },
    { title: "Thermo", image: "/public_html/images/index/thermo.jpg", tabKey: "tab3" },
  ],
  buttonText = "Ver m치s",
  baseUrl = "/public_html/servicios"
} = Astro.props;
---

<section class="bg-[#121843] py-16 lg:py-20" x-data="{ modalOpen: false, modalImage: '' }">
  <div class="max-w-7xl mx-auto px-4">
    <!-- T칤tulo -->
    <AnimateEntrance client:load origin={"Left"} useScrollTrigger={true} triggerClass="title-col" stagger={0.2}>
  <h2 class="titulo-pricing title-col">
    {mainTitle}
  </h2>
</AnimateEntrance>

  <AnimateEntrance client:load origin={"bottom"} useScrollTrigger={true} triggerClass="images-col" stagger={0.2}>
  <div class="grid gap-8 sm:grid-cols-2 lg:grid-cols-3">
    {services.map((service) => (
      <div class="flex flex-col items-center">
        <!-- T칤tulo de la card -->
        <h3 class="titulo-card-pricing">
          {service.title}
        </h3>

        <!-- Imagen con overlay -->
        <div 
          class="relative w-full glow-container max-w-xs h-56 sm:h-64 lg:h-72 rounded-xl overflow-hidden shadow-lg group cursor-pointer images-col"
          @click={`modalImage = '${service.image}'; modalOpen = true`}
        >
            <!-- 游댠 Glow animado detr치s -->
          <AnimatedGlowBorder client:load color="rgba(251,191,10  ,1)" thickness={4} />

          <img 
            src={service.image} 
            alt={service.title} 
            class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105" 
          />

          <!-- Overlay oscuro -->
          <div class="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition duration-300 flex items-center justify-center">
            <!-- Icono lupa -->
            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-4.35-4.35m0 0A7.5 7.5 0 1110.5 3a7.5 7.5 0 016.15 13.65z" />
            </svg>
          </div>
        </div>

        <!-- Bot칩n -->
        <button class="boton-card-pricing">
        <a
    href={`${baseUrl}?tab=${service.tabKey}`}
    class="boton-card-servicio inline-flex items-center gap-2"
    >
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h4l3 10 4-18 3 8h4" />
      </svg>
      {buttonText}
      </a>
        </button>
      </div>
    ))}
  </div>
  </AnimateEntrance>
    
  </div>

  <!-- Modal -->
<div 
  x-show="modalOpen" 
  x-transition 
  class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm"
  @click.self="modalOpen = false" 
  x-init="$watch('modalOpen', value => { 
    if (value) { document.body.classList.add('overflow-hidden') } 
    else { document.body.classList.remove('overflow-hidden') } 
  })"
>
  <!-- Contenedor imagen -->
  <div class="relative max-w-4xl w-full mx-4">
    <!-- Bot칩n cerrar -->
    <button 
      @click="modalOpen = false"
      class="absolute -top-4 -right-4 bg-white rounded-full p-2 shadow-lg hover:bg-gray-200 transition"
    >
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-800" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
      </svg>
    </button>

    <!-- Imagen -->
    <img 
      :src="modalImage" 
      alt="Vista completa" 
      class="w-full h-auto rounded-lg shadow-lg"
    />
  </div>
</div>